import{c as X,r as v,j as M,T as Y,a as m,C as A,G as D,B as E,P as B,M as j,b as _,d as L,R as $,e as N}from"./vendor.c5e950f2.js";const G=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const y of o.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&d(y)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}};G();let S;async function U(){S=await window.showDirectoryPicker();const c=[],s=new RegExp(/map_(\d+)_(\d+).bin/);for await(const n of S.keys()){const d=s.exec(n);if(d){const[e,o,y]=d;c.push({x:parseInt(o),y:parseInt(y)})}}return c}function q(c,s){const n=c.filter(e=>R(e,s)).map(({x:e,y:o})=>`map_${e}_${o}.bin`),d=new Promise(async e=>{for(const o of n)console.log("Deleting ",o),await S.removeEntry(o);e("")});return[c.filter(e=>!R(e,s)),d]}function R(c,s){const[n,d]=s;return n.x<=c.x&&c.x<=d.x&&n.y<=c.y&&c.y<=d.y}const z=X({palette:{mode:"dark"}}),g=1,F={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function H(){const[c,s]=v.exports.useState(!1),[n,d]=v.exports.useState(),[e,o]=v.exports.useState([]),y=v.exports.useRef(null),k=v.exports.useRef(null);v.exports.useEffect(()=>{const t=y.current,a=k.current;if(!t||!a)return;const i=t.getContext("2d");if(!i)return;let l=1,x=1;for(const{x:p,y:b}of e)l=Math.max(p,l),x=Math.max(b,x);a.width=t.width=l*g,a.height=t.height=x*g,i.fillStyle="hsla(41, 30%, 61%, 1)",i.fillRect(0,0,l*g,x*g);for(const p of e)i.fillStyle=!n||R(p,n)?"#f66":"hsla(41, 49%, 76%, 1)",i.fillRect(p.x*g,p.y*g,1*g,1*g)},[e,n]),v.exports.useEffect(()=>{const t=k.current;if(!t)return;const a=t.getContext("2d");if(!a)return;let i={x:0,y:0},l;const x=r=>{const h=t.getBoundingClientRect(),u=r.clientX-Math.floor(h.left),f=r.clientY-Math.floor(h.top),C=0<=u&&u<h.width&&0<=f&&f<h.height;return{x:u,y:f,isOverCanvas:C}},p=()=>{const r=i.x,h=i.y;if(a.clearRect(0,0,t.width,t.height),a.fillStyle="black",a.fillText(`X: ${r} Y: ${r}`,4,12),l){const u=l.x,f=l.y;a.fillStyle="#f664",a.strokeStyle="#f66c",a.fillRect(u,f,r-u,h-f),a.strokeRect(u,f,r-u,h-f)}},b=r=>{i=x(r),p()},P=r=>{!x(r).isOverCanvas||(r.preventDefault(),l=x(r),p())},O=r=>{if(r.preventDefault(),!l)return;const h=i.x,u=i.y,f=l.x,C=l.y,T={x:Math.min(h,f),y:Math.min(u,C)},I={x:Math.max(h,f),y:Math.max(u,C)};l=void 0,p(),d([T,I])};return document.body.addEventListener("mousemove",b),document.body.addEventListener("mousedown",P),document.body.addEventListener("mouseup",O),p(),()=>{document.body.removeEventListener("mousemove",b),document.body.removeEventListener("mousedown",P),document.body.removeEventListener("mouseup",O)}},[]);const w=v.exports.useMemo(()=>n?e.filter(t=>R(t,n)).length:0,[e,n]);return M(Y,{theme:z,children:[m(A,{}),M(D,{container:!0,spacing:1,justifyContent:"center",style:{marginTop:"2rem"},children:[M(D,{item:!0,xs:8,justifyContent:"space-between",children:[m(E,{onClick:()=>{U().then(t=>{o(t)})},children:"Load map data"}),M(E,{color:"error",disabled:w===0,onClick:()=>s(!0),children:["Delete ",w," chunks"]})]}),m(D,{item:!0,children:M(B,{style:{padding:"1rem",display:e.length>0?"grid":"none"},children:[m("canvas",{ref:y,style:{gridArea:"1 / 1"}}),m("canvas",{ref:k,style:{gridArea:"1 / 1"}})]})})]}),m(j,{open:c,onClose:()=>s(!1),onMouseDownCapture:t=>{t.nativeEvent.stopImmediatePropagation(),t.nativeEvent.stopPropagation()},onMouseUpCapture:t=>{t.nativeEvent.stopImmediatePropagation(),t.nativeEvent.stopPropagation()},children:M(_,{sx:F,children:[m(L,{variant:"h6",component:"h2",children:"Delete?"}),M(L,{sx:{mt:2},children:["Are you sure you would like to delete ",w," chunk",w>1?"s":"","?"]}),m(L,{sx:{mt:2},children:"This action is not reversible! Make sure you back up your save folder before proceeding!"}),m(E,{color:"error",variant:"contained",sx:{mt:2},onClick:()=>{if(!n){s(!1),console.error("");return}const[t,a]=q(e,n);a.then(i=>{i?console.error("Something went wrong! "+i):o(t)}),s(!1)},children:"Delete forever!"})]})})]})}$.render(m(N.StrictMode,{children:m(H,{})}),document.getElementById("root"));
