import{c as B,r as x,j as w,T as j,a as p,C as _,G as R,B as E,b as S,P as $,M as N,d as G,R as H,e as K}from"./vendor.0d93bac9.js";const U=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&d(n)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}};U();let L;async function q(){L=await window.showDirectoryPicker();const l=[],a=new RegExp(/map_(\d+)_(\d+).bin/);for await(const s of L.keys()){const d=a.exec(s);if(d){const[e,t,n]=d;l.push({x:parseInt(t),y:parseInt(n)})}}return l}function z(l,a,s){const d=l.filter(t=>k(t,a,s)).map(({x:t,y:n})=>`map_${t}_${n}.bin`),e=new Promise(async t=>{for(const n of d)console.log("Deleting ",n),await L.removeEntry(n);t("")});return[l.filter(t=>!k(t,a,s)),e]}function k(l,a,s){const[d,e]=a,t=d.x<=l.x&&l.x<=e.x&&d.y<=l.y&&l.y<=e.y;return!s&&t||s&&!t}const F=B({palette:{mode:"dark"}}),M=1,J={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function Q(){const[l,a]=x.exports.useState(!1),[s,d]=x.exports.useState(),[e,t]=x.exports.useState(!1),[n,P]=x.exports.useState([]),I=x.exports.useRef(null),D=x.exports.useRef(null);x.exports.useEffect(()=>{const o=I.current,i=D.current;if(!o||!i)return;const c=o.getContext("2d");if(!c)return;let u=1,v=1;for(const{x:y,y:g}of n)u=Math.max(y,u),v=Math.max(g,v);i.width=o.width=u*M,i.height=o.height=v*M,c.fillStyle="hsla(41, 30%, 61%, 1)",c.fillRect(0,0,u*M,v*M);for(const y of n){const g=s&&k(y,s,e);c.fillStyle=g?"#f66":"hsla(41, 49%, 76%, 1)",c.fillRect(y.x*M,y.y*M,1*M,1*M)}},[n,s,e]),x.exports.useEffect(()=>{const o=D.current;if(!o)return;const i=o.getContext("2d");if(!i)return;let c={x:0,y:0},u,v;const y=r=>{const h=o.getBoundingClientRect(),f=r.clientX-Math.floor(h.left),m=r.clientY-Math.floor(h.top),C=0<=f&&f<h.width&&0<=m&&m<h.height;return{x:f,y:m,isOverCanvas:C}},g=()=>{const r=c.x,h=c.y;if(i.clearRect(0,0,o.width,o.height),u){const f=u.x,m=u.y;i.fillStyle="#f664",v?(i.fillRect(0,0,o.width,o.height),i.clearRect(f,m,r-f,h-m)):i.fillRect(f,m,r-f,h-m),i.strokeStyle="#f66c",i.strokeRect(f,m,r-f,h-m)}i.fillStyle="black",i.fillText(`X: ${r} Y: ${r}`,4,12)},O=r=>{c=y(r),g()},T=r=>{!y(r).isOverCanvas||(r.preventDefault(),u=y(r),v=r.ctrlKey,d(void 0),t(v),g())},X=r=>{if(r.preventDefault(),!u)return;const h=c.x,f=c.y,m=u.x,C=u.y,Y={x:Math.min(h,m),y:Math.min(f,C)},A={x:Math.max(h,m),y:Math.max(f,C)};u=void 0,g(),d([Y,A])};return document.body.addEventListener("mousemove",O),document.body.addEventListener("mousedown",T),document.body.addEventListener("mouseup",X),g(),()=>{document.body.removeEventListener("mousemove",O),document.body.removeEventListener("mousedown",T),document.body.removeEventListener("mouseup",X)}},[]);const b=x.exports.useMemo(()=>s?n.filter(o=>k(o,s,e)).length:0,[n,s,e]);return w(j,{theme:F,children:[p(_,{}),w(R,{container:!0,spacing:1,justifyContent:"center",style:{marginTop:"2rem"},children:[w(R,{item:!0,xs:8,justifyContent:"space-between",children:[p(E,{onClick:()=>{q().then(o=>{P(o)})},children:"Load map data"}),w(E,{color:"error",disabled:b===0,onClick:()=>a(!0),children:["Delete ",b," chunks"]})]}),p(R,{item:!0,xs:8,sx:{ml:2},children:p(S,{children:"Hold Ctrl before selecting a region to invert it"})}),p(R,{item:!0,children:w($,{style:{padding:"1rem",display:n.length>0?"grid":"none"},children:[p("canvas",{ref:I,style:{gridArea:"1 / 1"}}),p("canvas",{ref:D,style:{gridArea:"1 / 1"}})]})})]}),p(N,{open:l,onClose:()=>a(!1),onMouseDownCapture:o=>{o.nativeEvent.stopImmediatePropagation(),o.nativeEvent.stopPropagation()},onMouseUpCapture:o=>{o.nativeEvent.stopImmediatePropagation(),o.nativeEvent.stopPropagation()},children:w(G,{sx:J,children:[p(S,{variant:"h6",component:"h2",children:"Delete?"}),w(S,{sx:{mt:2},children:["Are you sure you would like to delete ",b," chunk",b>1?"s":"","?"]}),p(S,{sx:{mt:2},children:"This action is not reversible! Make sure you back up your save folder before proceeding!"}),p(E,{color:"error",variant:"contained",sx:{mt:2},onClick:()=>{if(!s){a(!1),console.error("");return}const[o,i]=z(n,s,e);i.then(c=>{c?console.error("Something went wrong! "+c):P(o)}),a(!1)},children:"Delete forever!"})]})})]})}H.render(p(K.StrictMode,{children:p(Q,{})}),document.getElementById("root"));
